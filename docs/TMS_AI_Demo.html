<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI SQL Tuning Advisor - TMS v2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .ai-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: normal;
        }
        
        /* SQL Input Section */
        .sql-input {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Consolas', monospace;
            font-size: 12px;
            resize: vertical;
        }
        
        .sql-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .info-item {
            padding: 8px;
            background: #f8f9fa;
            border-radius: 5px;
            font-size: 12px;
        }
        
        .info-label {
            color: #6c757d;
            font-size: 10px;
        }
        
        .info-value {
            font-weight: bold;
            color: #2c3e50;
            font-size: 14px;
        }
        
        .analyze-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .analyze-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        /* AI Analysis Results */
        .ai-analysis {
            display: none;
        }
        
        .ai-analysis.active {
            display: block;
        }
        
        .severity-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .severity-critical {
            background: #ffe0e0;
            color: #d32f2f;
        }
        
        .severity-high {
            background: #fff3cd;
            color: #f57c00;
        }
        
        .severity-medium {
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .severity-low {
            background: #e8f5e9;
            color: #388e3c;
        }
        
        .diagnosis-item {
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .diagnosis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .diagnosis-title {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .diagnosis-description {
            color: #666;
            font-size: 12px;
            line-height: 1.6;
        }
        
        .confidence-meter {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 5px;
        }
        
        .confidence-bar {
            flex: 1;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s;
        }
        
        .confidence-text {
            font-size: 11px;
            color: #666;
            min-width: 35px;
        }
        
        /* Recommendations */
        .recommendation-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .tab-btn {
            padding: 8px 15px;
            background: #f0f0f0;
            border: none;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            background: #667eea;
            color: white;
        }
        
        .recommendation-content {
            display: none;
        }
        
        .recommendation-content.active {
            display: block;
        }
        
        .step {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .step-number {
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            flex-shrink: 0;
        }
        
        .step-content {
            flex: 1;
        }
        
        .step-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .code-block {
            background: #2c3e50;
            color: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Consolas', monospace;
            font-size: 11px;
            margin: 10px 0;
            overflow-x: auto;
        }
        
        .code-block .keyword {
            color: #66d9ef;
        }
        
        .code-block .string {
            color: #e6db74;
        }
        
        /* Expected Results */
        .metrics-comparison {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        
        .metric-column {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .metric-column.before {
            border-left: 4px solid #e74c3c;
        }
        
        .metric-column.after {
            border-left: 4px solid #27ae60;
        }
        
        .metric-title {
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .metric-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 12px;
        }
        
        .metric-value {
            font-weight: bold;
        }
        
        .improvement {
            color: #27ae60;
            font-size: 10px;
        }
        
        .arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #667eea;
        }
        
        /* Auto Execute */
        .auto-execute {
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
        }
        
        .execute-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }
        
        .execute-btn {
            width: 100%;
            padding: 10px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .execute-btn:hover {
            background: #229954;
            transform: translateY(-1px);
        }
        
        /* Loading State */
        .loading {
            text-align: center;
            padding: 40px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f0f0f0;
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: #666;
            font-size: 14px;
        }
        
        /* Success Message */
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            display: none;
        }
        
        .success-message.show {
            display: block;
        }
        
        /* Improvement Chart */
        .improvement-chart {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        
        .chart-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .chart-label {
            min-width: 100px;
            font-size: 12px;
            color: #666;
        }
        
        .chart-progress {
            flex: 1;
            height: 25px;
            background: #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .chart-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 1s ease-out;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
        }
        
        .chart-value {
            color: white;
            font-size: 11px;
            font-weight: bold;
        }
        
        /* Sample SQLs */
        .sample-sqls {
            margin-top: 15px;
        }
        
        .sample-btn {
            display: block;
            width: 100%;
            padding: 10px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: left;
            cursor: pointer;
            margin-bottom: 5px;
            transition: all 0.3s;
            font-size: 12px;
        }
        
        .sample-btn:hover {
            background: #e0e0e0;
        }
        
        .sample-label {
            font-weight: bold;
            color: #667eea;
        }
        
        .sample-desc {
            color: #666;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ AI SQL Tuning Advisor</h1>
            <p>Î®∏Ïã†Îü¨Îãù Í∏∞Î∞ò Ïã§ÏãúÍ∞Ñ SQL ÏÑ±Îä• Î∂ÑÏÑù Î∞è ÌäúÎãù Í∞ÄÏù¥Îìú</p>
        </div>
        
        <div class="main-grid">
            <!-- Left Panel: SQL Input -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <span>üìù</span>
                        SQL ÏûÖÎ†•
                    </h3>
                </div>
                
                <textarea id="sqlInput" class="sql-input" placeholder="Î∂ÑÏÑùÌï† SQLÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...">SELECT o.order_id, o.order_date, c.customer_name, p.product_name
FROM orders o, customers c, products p, order_items oi
WHERE o.customer_id = c.customer_id
AND o.order_id = oi.order_id
AND oi.product_id = p.product_id
AND o.order_date >= SYSDATE - 30
AND o.status = 'PENDING'</textarea>
                
                <div class="sql-info">
                    <div class="info-item">
                        <div class="info-label">SQL ID</div>
                        <div class="info-value">abc123def456</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Elapsed Time</div>
                        <div class="info-value">5,234ms</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Buffer Gets</div>
                        <div class="info-value">523,456</div>
                    </div>
                </div>
                
                <button class="analyze-btn" onclick="analyzeSQL()">
                    ü§ñ AI Î∂ÑÏÑù ÏãúÏûë
                </button>
                
                <div class="sample-sqls">
                    <div class="sample-btn" onclick="loadSampleSQL(1)">
                        <div class="sample-label">ÏÉòÌîå 1: Full Table Scan</div>
                        <div class="sample-desc">ÎåÄÏö©Îüâ ÌÖåÏù¥Î∏î Ï†ÑÏ≤¥ Ïä§Ï∫î Î¨∏Ï†ú</div>
                    </div>
                    <div class="sample-btn" onclick="loadSampleSQL(2)">
                        <div class="sample-label">ÏÉòÌîå 2: Missing Index</div>
                        <div class="sample-desc">Ïù∏Îç±Ïä§ Î∂ÄÏû¨Î°ú Ïù∏Ìïú ÏÑ±Îä• Ï†ÄÌïò</div>
                    </div>
                    <div class="sample-btn" onclick="loadSampleSQL(3)">
                        <div class="sample-label">ÏÉòÌîå 3: Cartesian Join</div>
                        <div class="sample-desc">ÏûòÎ™ªÎêú Ï°∞Ïù∏ Ï°∞Í±¥</div>
                    </div>
                </div>
            </div>
            
            <!-- Right Panel: AI Analysis -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <span>üîç</span>
                        AI Î∂ÑÏÑù Í≤∞Í≥º
                        <span class="ai-badge">AI Powered</span>
                    </h3>
                </div>
                
                <div id="loadingState" class="loading" style="display: none;">
                    <div class="spinner"></div>
                    <div class="loading-text">AIÍ∞Ä SQLÏùÑ Î∂ÑÏÑùÏ§ëÏûÖÎãàÎã§...</div>
                </div>
                
                <div id="aiAnalysis" class="ai-analysis">
                    <!-- AI Diagnosis -->
                    <div class="section">
                        <h4 style="margin-bottom: 15px; color: #2c3e50;">üìä Î¨∏Ï†ú ÏßÑÎã®</h4>
                        <div id="diagnosisList"></div>
                    </div>
                    
                    <!-- Recommendations -->
                    <div class="section" style="margin-top: 20px;">
                        <h4 style="margin-bottom: 15px; color: #2c3e50;">üõ†Ô∏è ÌäúÎãù Î∞©Î≤ï</h4>
                        <div class="recommendation-tabs">
                            <button class="tab-btn active" onclick="switchTab('index')">Ïù∏Îç±Ïä§ ÏÉùÏÑ±</button>
                            <button class="tab-btn" onclick="switchTab('rewrite')">SQL Ïû¨ÏûëÏÑ±</button>
                            <button class="tab-btn" onclick="switchTab('hint')">ÌûåÌä∏ Ï∂îÍ∞Ä</button>
                        </div>
                        
                        <div id="indexTab" class="recommendation-content active"></div>
                        <div id="rewriteTab" class="recommendation-content"></div>
                        <div id="hintTab" class="recommendation-content"></div>
                    </div>
                    
                    <!-- Expected Results -->
                    <div class="section" style="margin-top: 20px;">
                        <h4 style="margin-bottom: 15px; color: #2c3e50;">üìà ÏòàÏÉÅ Í∞úÏÑ† Í≤∞Í≥º</h4>
                        <div id="expectedResults"></div>
                    </div>
                    
                    <!-- Improvement Chart -->
                    <div class="improvement-chart">
                        <h4 style="margin-bottom: 15px; color: #2c3e50;">ÏÑ±Îä• Í∞úÏÑ† ÏòàÏ∏°</h4>
                        <div id="improvementChart"></div>
                    </div>
                    
                    <!-- Auto Execute -->
                    <div class="auto-execute">
                        <h4 style="margin-bottom: 10px; color: #2c3e50;">üöÄ ÏûêÎèô Ïã§Ìñâ</h4>
                        <div class="execute-options">
                            <label class="option-item">
                                <input type="checkbox" id="testFirst" checked>
                                <span>ÌÖåÏä§Ìä∏ ÌôòÍ≤ΩÏóêÏÑú Î®ºÏ†Ä Ïã§Ìñâ</span>
                            </label>
                            <label class="option-item">
                                <input type="checkbox" id="requireApproval">
                                <span>Ïã§Ìñâ Ï†Ñ ÏäπÏù∏ ÏöîÏ≤≠</span>
                            </label>
                            <label class="option-item">
                                <input type="checkbox" id="autoRollback" checked>
                                <span>Î¨∏Ï†ú Î∞úÏÉùÏãú ÏûêÎèô Î°§Î∞±</span>
                            </label>
                        </div>
                        <button class="execute-btn" onclick="executeTuning()">
                            AI ÌäúÎãù Ïã§Ìñâ
                        </button>
                    </div>
                    
                    <div id="successMessage" class="success-message">
                        ‚úÖ ÌäúÎãùÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Sample SQL queries
        const sampleSQLs = {
            1: `SELECT * FROM orders WHERE order_date >= SYSDATE - 365`,
            2: `SELECT o.*, c.* 
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
WHERE o.order_date BETWEEN '2024-01-01' AND '2024-12-31'
AND c.country = 'USA'`,
            3: `SELECT * FROM employees e, departments d
WHERE e.salary > 50000`
        };
        
        // AI Analysis Engine (Simulated)
        class AITuningAdvisor {
            analyzeSQL(sql) {
                // ÏãúÎÆ¨Î†àÏù¥ÏÖòÎêú AI Î∂ÑÏÑù Í≤∞Í≥º
                const patterns = this.detectPatterns(sql);
                const diagnosis = this.diagnoseProblems(patterns);
                const recommendations = this.generateRecommendations(diagnosis);
                const predictions = this.predictImprovement(diagnosis);
                
                return {
                    diagnosis,
                    recommendations,
                    predictions
                };
            }
            
            detectPatterns(sql) {
                const patterns = [];
                
                if (sql.includes('SELECT *')) {
                    patterns.push('SELECT_STAR');
                }
                if (!sql.match(/JOIN.*ON/i) && sql.includes(',')) {
                    patterns.push('IMPLICIT_JOIN');
                }
                if (sql.match(/WHERE.*OR/i)) {
                    patterns.push('OR_CONDITION');
                }
                if (!sql.match(/INDEX/i)) {
                    patterns.push('MISSING_INDEX_HINT');
                }
                
                return patterns;
            }
            
            diagnoseProblems(patterns) {
                const problems = [];
                
                problems.push({
                    type: 'FULL_TABLE_SCAN',
                    severity: 'CRITICAL',
                    title: 'Full Table Scan Î∞úÍ≤¨',
                    description: 'ORDERS ÌÖåÏù¥Î∏î (5,000,000 rows)ÏóêÏÑú Ï†ÑÏ≤¥ Ïä§Ï∫îÏù¥ Î∞úÏÉùÌïòÍ≥† ÏûàÏäµÎãàÎã§. Ïù¥Îäî Ï†ÑÏ≤¥ Ïã§ÌñâÏãúÍ∞ÑÏùò 85%Î•º Ï∞®ÏßÄÌï©ÎãàÎã§.',
                    confidence: 0.95,
                    impact: 'Ïã§ÌñâÏãúÍ∞ÑÏùò 85%'
                });
                
                problems.push({
                    type: 'MISSING_INDEX',
                    severity: 'HIGH',
                    title: 'Ïù∏Îç±Ïä§ Î∂ÄÏû¨',
                    description: 'ORDER_DATE, CUSTOMER_ID Ïª¨ÎüºÏóê Ï†ÅÏ†àÌïú Ïù∏Îç±Ïä§Í∞Ä ÏóÜÏäµÎãàÎã§. Î≥µÌï© Ïù∏Îç±Ïä§ ÏÉùÏÑ±Ïãú 80% ÏÑ±Îä• Í∞úÏÑ†Ïù¥ ÏòàÏÉÅÎê©ÎãàÎã§.',
                    confidence: 0.88,
                    impact: 'Buffer Gets 80% Í∞êÏÜå Í∞ÄÎä•'
                });
                
                if (patterns.includes('IMPLICIT_JOIN')) {
                    problems.push({
                        type: 'INEFFICIENT_JOIN',
                        severity: 'MEDIUM',
                        title: 'ÎπÑÌö®Ïú®Ï†ÅÏù∏ Ï°∞Ïù∏',
                        description: 'ÏïîÏãúÏ†Å Ï°∞Ïù∏ ÏÇ¨Ïö©ÏúºÎ°ú Ïù∏Ìï¥ ÏòµÌã∞ÎßàÏù¥Ï†ÄÍ∞Ä ÏµúÏ†ÅÏùò Ï°∞Ïù∏ ÏàúÏÑúÎ•º ÏÑ†ÌÉùÌïòÏßÄ Î™ªÌï† Ïàò ÏûàÏäµÎãàÎã§.',
                        confidence: 0.72,
                        impact: 'Ï°∞Ïù∏ ÏÑ±Îä• 30% Í∞úÏÑ† Í∞ÄÎä•'
                    });
                }
                
                return problems;
            }
            
            generateRecommendations(diagnosis) {
                return {
                    index: [
                        {
                            step: 1,
                            title: 'Î≥µÌï© Ïù∏Îç±Ïä§ ÏÉùÏÑ±',
                            code: `CREATE INDEX idx_orders_date_cust 
ON orders(order_date, customer_id)
TABLESPACE indexes
PARALLEL 8;`,
                            description: 'Í∞ÄÏû• ÏÑ†ÌÉùÎèÑÍ∞Ä ÎÜíÏùÄ Ïª¨Îüº ÏàúÏÑúÎ°ú Î≥µÌï© Ïù∏Îç±Ïä§Î•º ÏÉùÏÑ±Ìï©ÎãàÎã§.'
                        },
                        {
                            step: 2,
                            title: 'ÌÜµÍ≥ÑÏ†ïÎ≥¥ ÏàòÏßë',
                            code: `EXEC DBMS_STATS.GATHER_INDEX_STATS(
    ownname => 'SCOTT',
    indname => 'IDX_ORDERS_DATE_CUST'
);`,
                            description: 'ÏÉàÎ°ú ÏÉùÏÑ±Îêú Ïù∏Îç±Ïä§Ïùò ÌÜµÍ≥ÑÏ†ïÎ≥¥Î•º ÏàòÏßëÌï©ÎãàÎã§.'
                        },
                        {
                            step: 3,
                            title: 'Ïã§ÌñâÍ≥ÑÌöç ÌôïÏù∏',
                            code: `SELECT * FROM table(
    DBMS_XPLAN.DISPLAY_CURSOR('abc123def456')
);`,
                            description: 'Ïù∏Îç±Ïä§Í∞Ä ÏÇ¨Ïö©ÎêòÎäîÏßÄ Ïã§ÌñâÍ≥ÑÌöçÏùÑ ÌôïÏù∏Ìï©ÎãàÎã§.'
                        }
                    ],
                    rewrite: [
                        {
                            step: 1,
                            title: 'ANSI Ï°∞Ïù∏ÏúºÎ°ú Î≥ÄÍ≤Ω',
                            code: `SELECT o.order_id, o.order_date, 
       c.customer_name, p.product_name
FROM orders o
INNER JOIN customers c 
    ON o.customer_id = c.customer_id
INNER JOIN order_items oi 
    ON o.order_id = oi.order_id
INNER JOIN products p 
    ON oi.product_id = p.product_id
WHERE o.order_date >= SYSDATE - 30
    AND o.status = 'PENDING';`,
                            description: 'Î™ÖÏãúÏ†Å Ï°∞Ïù∏ Íµ¨Î¨∏ÏúºÎ°ú Î≥ÄÍ≤ΩÌïòÏó¨ Í∞ÄÎèÖÏÑ±Í≥º ÏÑ±Îä•ÏùÑ Í∞úÏÑ†Ìï©ÎãàÎã§.'
                        }
                    ],
                    hint: [
                        {
                            step: 1,
                            title: 'Ïù∏Îç±Ïä§ ÌûåÌä∏ Ï∂îÍ∞Ä',
                            code: `SELECT /*+ INDEX(o idx_orders_date_cust) 
           LEADING(o) 
           USE_NL(c) */
       o.order_id, o.order_date, 
       c.customer_name
FROM orders o
JOIN customers c 
    ON o.customer_id = c.customer_id
WHERE o.order_date >= SYSDATE - 30;`,
                            description: 'ÏòµÌã∞ÎßàÏù¥Ï†ÄÏóêÍ≤å Ïù∏Îç±Ïä§ ÏÇ¨Ïö©Í≥º Ï°∞Ïù∏ ÏàúÏÑúÎ•º Î™ÖÏãúÏ†ÅÏúºÎ°ú ÏßÄÏãúÌï©ÎãàÎã§.'
                        }
                    ]
                };
            }
            
            predictImprovement(diagnosis) {
                return {
                    elapsed_time: { before: 5234, after: 234, improvement: 95 },
                    buffer_gets: { before: 523456, after: 4567, improvement: 99 },
                    cpu_time: { before: 3234, after: 123, improvement: 96 },
                    disk_reads: { before: 12345, after: 234, improvement: 98 },
                    overall_improvement: 92
                };
            }
        }
        
        const aiAdvisor = new AITuningAdvisor();
        
        // Load sample SQL
        function loadSampleSQL(id) {
            document.getElementById('sqlInput').value = sampleSQLs[id];
        }
        
        // Analyze SQL with AI
        function analyzeSQL() {
            const sqlInput = document.getElementById('sqlInput').value;
            if (!sqlInput.trim()) {
                alert('SQLÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî');
                return;
            }
            
            // Show loading state
            document.getElementById('loadingState').style.display = 'block';
            document.getElementById('aiAnalysis').classList.remove('active');
            
            // Simulate AI processing
            setTimeout(() => {
                const analysis = aiAdvisor.analyzeSQL(sqlInput);
                displayAnalysis(analysis);
                
                document.getElementById('loadingState').style.display = 'none';
                document.getElementById('aiAnalysis').classList.add('active');
            }, 2000);
        }
        
        // Display AI analysis results
        function displayAnalysis(analysis) {
            // Display diagnosis
            const diagnosisHTML = analysis.diagnosis.map(problem => {
                const severityClass = `severity-${problem.severity.toLowerCase()}`;
                return `
                    <div class="diagnosis-item">
                        <div class="diagnosis-header">
                            <div class="diagnosis-title">${problem.title}</div>
                            <span class="severity-badge ${severityClass}">${problem.severity}</span>
                        </div>
                        <div class="diagnosis-description">${problem.description}</div>
                        <div class="confidence-meter">
                            <span style="font-size: 11px; color: #666;">AI Ïã†Î¢∞ÎèÑ:</span>
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: ${problem.confidence * 100}%"></div>
                            </div>
                            <span class="confidence-text">${Math.round(problem.confidence * 100)}%</span>
                        </div>
                    </div>
                `;
            }).join('');
            document.getElementById('diagnosisList').innerHTML = diagnosisHTML;
            
            // Display recommendations
            displayRecommendations(analysis.recommendations);
            
            // Display expected results
            displayExpectedResults(analysis.predictions);
            
            // Display improvement chart
            displayImprovementChart(analysis.predictions);
        }
        
        function displayRecommendations(recommendations) {
            // Index tab
            const indexHTML = recommendations.index.map(step => `
                <div class="step">
                    <div class="step-number">${step.step}</div>
                    <div class="step-content">
                        <div class="step-title">${step.title}</div>
                        <div class="step-description">${step.description}</div>
                        <div class="code-block">${highlightSQL(step.code)}</div>
                    </div>
                </div>
            `).join('');
            document.getElementById('indexTab').innerHTML = indexHTML;
            
            // Rewrite tab
            const rewriteHTML = recommendations.rewrite.map(step => `
                <div class="step">
                    <div class="step-number">${step.step}</div>
                    <div class="step-content">
                        <div class="step-title">${step.title}</div>
                        <div class="step-description">${step.description}</div>
                        <div class="code-block">${highlightSQL(step.code)}</div>
                    </div>
                </div>
            `).join('');
            document.getElementById('rewriteTab').innerHTML = rewriteHTML;
            
            // Hint tab
            const hintHTML = recommendations.hint.map(step => `
                <div class="step">
                    <div class="step-number">${step.step}</div>
                    <div class="step-content">
                        <div class="step-title">${step.title}</div>
                        <div class="step-description">${step.description}</div>
                        <div class="code-block">${highlightSQL(step.code)}</div>
                    </div>
                </div>
            `).join('');
            document.getElementById('hintTab').innerHTML = hintHTML;
        }
        
        function displayExpectedResults(predictions) {
            const resultsHTML = `
                <div class="metrics-comparison">
                    <div class="metric-column before">
                        <div class="metric-title">Before</div>
                        <div class="metric-item">
                            <span>Elapsed Time</span>
                            <span class="metric-value">${predictions.elapsed_time.before.toLocaleString()}ms</span>
                        </div>
                        <div class="metric-item">
                            <span>Buffer Gets</span>
                            <span class="metric-value">${predictions.buffer_gets.before.toLocaleString()}</span>
                        </div>
                        <div class="metric-item">
                            <span>CPU Time</span>
                            <span class="metric-value">${predictions.cpu_time.before.toLocaleString()}ms</span>
                        </div>
                        <div class="metric-item">
                            <span>Disk Reads</span>
                            <span class="metric-value">${predictions.disk_reads.before.toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <div class="arrow">‚Üí</div>
                    
                    <div class="metric-column after">
                        <div class="metric-title">After</div>
                        <div class="metric-item">
                            <span>Elapsed Time</span>
                            <span class="metric-value">
                                ${predictions.elapsed_time.after.toLocaleString()}ms
                                <span class="improvement">(-${predictions.elapsed_time.improvement}%)</span>
                            </span>
                        </div>
                        <div class="metric-item">
                            <span>Buffer Gets</span>
                            <span class="metric-value">
                                ${predictions.buffer_gets.after.toLocaleString()}
                                <span class="improvement">(-${predictions.buffer_gets.improvement}%)</span>
                            </span>
                        </div>
                        <div class="metric-item">
                            <span>CPU Time</span>
                            <span class="metric-value">
                                ${predictions.cpu_time.after.toLocaleString()}ms
                                <span class="improvement">(-${predictions.cpu_time.improvement}%)</span>
                            </span>
                        </div>
                        <div class="metric-item">
                            <span>Disk Reads</span>
                            <span class="metric-value">
                                ${predictions.disk_reads.after.toLocaleString()}
                                <span class="improvement">(-${predictions.disk_reads.improvement}%)</span>
                            </span>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('expectedResults').innerHTML = resultsHTML;
        }
        
        function displayImprovementChart(predictions) {
            const chartHTML = `
                <div class="chart-bar">
                    <div class="chart-label">Elapsed Time</div>
                    <div class="chart-progress">
                        <div class="chart-fill" style="width: 0%">
                            <span class="chart-value">${predictions.elapsed_time.improvement}%</span>
                        </div>
                    </div>
                </div>
                <div class="chart-bar">
                    <div class="chart-label">Buffer Gets</div>
                    <div class="chart-progress">
                        <div class="chart-fill" style="width: 0%">
                            <span class="chart-value">${predictions.buffer_gets.improvement}%</span>
                        </div>
                    </div>
                </div>
                <div class="chart-bar">
                    <div class="chart-label">CPU Time</div>
                    <div class="chart-progress">
                        <div class="chart-fill" style="width: 0%">
                            <span class="chart-value">${predictions.cpu_time.improvement}%</span>
                        </div>
                    </div>
                </div>
                <div class="chart-bar">
                    <div class="chart-label">Overall</div>
                    <div class="chart-progress">
                        <div class="chart-fill" style="width: 0%">
                            <span class="chart-value">${predictions.overall_improvement}%</span>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('improvementChart').innerHTML = chartHTML;
            
            // Animate chart bars
            setTimeout(() => {
                const bars = document.querySelectorAll('.chart-fill');
                bars[0].style.width = predictions.elapsed_time.improvement + '%';
                bars[1].style.width = predictions.buffer_gets.improvement + '%';
                bars[2].style.width = predictions.cpu_time.improvement + '%';
                bars[3].style.width = predictions.overall_improvement + '%';
            }, 100);
        }
        
        function highlightSQL(sql) {
            return sql
                .replace(/\b(SELECT|FROM|WHERE|AND|OR|JOIN|ON|CREATE|INDEX|EXEC|INSERT|UPDATE|DELETE|INNER|LEFT|RIGHT)\b/gi, 
                    '<span class="keyword">$1</span>')
                .replace(/'[^']*'/g, '<span class="string">$&</span>');
        }
        
        function switchTab(tab) {
            // Remove active class from all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.recommendation-content').forEach(content => content.classList.remove('active'));
            
            // Add active class to selected tab
            event.target.classList.add('active');
            document.getElementById(tab + 'Tab').classList.add('active');
        }
        
        function executeTuning() {
            const testFirst = document.getElementById('testFirst').checked;
            const requireApproval = document.getElementById('requireApproval').checked;
            const autoRollback = document.getElementById('autoRollback').checked;
            
            if (requireApproval) {
                if (!confirm('ÌäúÎãù Ïã§ÌñâÏùÑ ÏäπÏù∏ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    return;
                }
            }
            
            // Show success message
            document.getElementById('successMessage').classList.add('show');
            
            // Hide after 5 seconds
            setTimeout(() => {
                document.getElementById('successMessage').classList.remove('show');
            }, 5000);
        }
        
        // Initialize with default SQL
        window.onload = function() {
            // Auto-analyze on load
            setTimeout(() => {
                analyzeSQL();
            }, 500);
        };
    </script>
</body>
</html>
